<script th:inline="javascript">
    function addMarker(longitude, latitude, address, temp, conditions, icon) {
    var iconImg = null;
    switch (icon) {
        case 'snow':
            iconImg = 'img/Snow_ICON.jpg';
            break;
        case 'rain':
            iconImg = 'img/Rain_ICON.jpg';
            break;
        case 'fog':
            iconImg = 'img/Fog_ICON.jpg';
            break;
        case 'wind':
            iconImg = 'img/Wind_ICON.jpg';
            break;
        case 'cloudy':
            iconImg = 'img/Cloudy_ICON.jpg';
            break;
        case 'partly-cloudy-day':
            iconImg = 'img/logo_meteo1.png';
            break;
        case 'partly-cloudy-night':
            iconImg = 'img/logo_meteo1.png';
            break;
        case 'clear-day':
            iconImg = 'img/logo_meteo1.png';
            break;
        case 'clear-night':
            iconImg = 'img/logo_meteo1.png';
            break;
        default:
            iconImg = 'img/logo_meteo1.png';
    }
    if (latitude !== null && longitude !== null) {
        L.marker([latitude, longitude], 10).addTo(map)
        .bindPopup("<div style='display: flex; align-items: center;'><img src=" + iconImg + " style='max-width: 100px; max-height: 100px; margin-right: 10px;'><div><strong>Voici la météo de " + address + "</strong><br>Température actuelle : " + temp + "°C<br>Conditions : " + conditions + "</div></div>").openPopup();

    } else {
        console.error('Latitude or longitude is undefined.');
    }
}
</script>

<div th:each="weatherData : ${weatherDataLists}">
    <!-- Afficher les détails de chaque entrée dans des balises <p> -->
    <p>Adresse longue : <span th:text="${weatherData.resolvedAddress}"></span></p>
    <!-- <p>Adresse courte : <span th:text="${weatherData.address}"></span></p>
    <p>Latitude : <span th:text="${weatherData.latitude}"></span></p>
    <p>Longitude : <span th:text="${weatherData.longitude}"></span></p>
    <p>TimeZone : <span th:text="${weatherData.timezone}"></span></p> -->
   
    <h2>Conditions actuelle :</h2>
    <table border="1">
        <thead>
            <tr>
                <th>Date</th>
                <th>Température</th>
                <th>Humidité</th>
                <th>Probabilités de précipitations</th>
                <th>Vitesse du vent</th>
                <th>Conditions</th>
                <th>Levé du soleil</th>
                <th>Couché du soleil</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td th:text="${weatherData.weatherDataCurrentConditions.datetime}"></td>
                <td th:text="${weatherData.weatherDataCurrentConditions.temp}"></td>
                <td th:text="${weatherData.weatherDataCurrentConditions.humidity}"></td>
                <td th:text="${weatherData.weatherDataCurrentConditions.precipprob}"></td>
                <td th:text="${weatherData.weatherDataCurrentConditions.windspeed}"></td>
                <td th:text="${weatherData.weatherDataCurrentConditions.conditions}"></td>
                <td th:text="${weatherData.weatherDataCurrentConditions.sunrise}"></td>
                <td th:text="${weatherData.weatherDataCurrentConditions.sunset}"></td>
            </tr>
        </tbody>
    </table>

    <!-- Ajoutez d'autres balises <p> selon vos besoins -->

    <!-- Boucle pour chaque weatherDay -->
    <table border="1">
        <thead>
            <tr>
                <th>Date</th>
                <th>Température</th>
                <th>Température Min</th>
                <th>Température Max</th>
                <th>Humidité</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="weatherDay : ${weatherData.weatherDay}">
                <td th:text="${weatherDay.datetime}"></td>
                <td th:text="${weatherDay.temp}"></td>
                <td th:text="${weatherDay.tempmin}"></td>
                <td th:text="${weatherDay.tempmax}"></td>
                <td th:text="${weatherDay.humidity}"></td>
            </tr>
        </tbody>
    </table>

    <!-- Boucle pour les heures de la première journée uniquement -->
    <table border="1">
        <thead>
            <tr>
                <th>Date et heure</th>
                <th>Température</th>
                <th>Humidité</th>
                <th>Probabilité de précipitations</th>
                <th>Vitesse du vent</th>
                <th>Conditions</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="weatherHour : ${weatherData.weatherDay[0].weatherHour}">
                <td th:text="${weatherHour.datetime}"></td>
                <td th:text="${weatherHour.temp}"></td>
                <td th:text="${weatherHour.humidity}"></td>
                <td th:text="${weatherHour.precipprob}"></td>
                <td th:text="${weatherHour.windspeed}"></td>
                <td th:text="${weatherHour.conditions}"></td>
            </tr>
        </tbody>
    </table>


    <script th:inline="javascript">
        console.log(/*[[${weatherData.weatherDataCurrentConditions.icon}]]*/ null);
        addMarker(/*[[${weatherData.longitude}]]*/ null, /*[[${weatherData.latitude}]]*/ null, /*[[${weatherData.address}]]*/ null, /*[[${weatherData.weatherDataCurrentConditions.temp}]]*/ null, /*[[${weatherData.weatherDataCurrentConditions.conditions}]]*/ null, /*[[${weatherData.weatherDataCurrentConditions.icon}]]*/ null);
    </script>
</div>



<div th:if="${#lists.isEmpty(weatherDataLists)}">
    <p>Aucune donnée météorologique disponible pour cette ville.</p>
</div>
